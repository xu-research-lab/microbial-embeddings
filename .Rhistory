View(table)
View(biom_df)
table_pick <- table_pick[rownames(metadata_pick), ]
table_pick <- biom_df[rownames(metadata_pick), ]
View(table_pick)
table_pick <- biom_df[rownames(metadata_pick), ] %>% select_if(~ any(. != 0))
View(table_pick)
?adonis2
res <- adonis2(table_pick ~ group, data = metadata_pick, by = "terms")
res
res
res$R2
res$`Pr(>F)`
study <- c('PRJNA422193', 'PRJNA431126', 'qiita_1629', 'qiita_2538', 'HMP', 'PRJEB13679', 'PRJNA317429')
p_value <- c()
R <- c()
for (i in study){
metadata_pick <- metadata %>% filter(Bioproject == i)
table_pick <- biom_df[rownames(metadata_pick), ] %>% select_if(~ any(. != 0))
res <- adonis2(table_pick ~ group, data = metadata_pick, by = "terms")
p_value <- c(p_value, res$`Pr(>F)`[1])
R <- r(R, res$R2[1])
}
p_value <- c()
R <- c()
for (i in study){
metadata_pick <- metadata %>% filter(Bioproject == i)
table_pick <- biom_df[rownames(metadata_pick), ] %>% select_if(~ any(. != 0))
res <- adonis2(table_pick ~ group, data = metadata_pick, by = "terms")
p_value <- c(p_value, res$`Pr(>F)`[1])
R <- c(R, res$R2[1])
}
p_value
R
res <- adonis2(biom_df ~ group + Condition(Bioproject), data = metadata, by = "terms")
?adonis
res <- adonis2(biom_df ~ group, data = metadata, by = "terms", strata="Bioproject")
res <- adonis2(biom_df ~ group, data = metadata, by = "terms", strata=Bioproject)
res
res <- adonis2(biom_df ~ group, data = metadata, by = "terms", strata=Bioproject)
res <- adonis2(biom_df ~ group, data = metadata, by = "terms", strata=metadata$Bioproject)
res
p_value <- c(p_value, res$`Pr(>F)`[1])
R <- c(R, res$R2[1])
p_value
R
# embedding transfor
embedding_file = read.table("/home/dongbiao/word_embedding_microbiome/databaes/16Sdatabase/glove/abundance-percentile/abundance-percentile_100.txt",
sep = " ", row.names = 1, header = FALSE)
inter_id <- intersect(rownames(embedding_file), colnames(biom_df))
embed_tf <- as.matrix(biom_df[, inter_id]) %*% as.matrix(embedding_file[inter_id, ])
# distance <- vegdist(embed_tf, method = "euclidean")
distance <- proxy::dist(embed_tf, method = "cosine")
# distance <- vegdist(embed_tf, method = "euclidean")
distance <- proxy::dist(embed_tf, method = "cosine")
p_value_embed_trans <- c()
R_embed_trans <- c()
for (i in study){
metadata_pick <- metadata %>% filter(Bioproject == i)
embed_tf_pick <- embed_tf[rownames(metadata_pick), ] %>% select_if(~ any(. != 0))
distance <- proxy::dist(embed_tf_pick, method = "cosine")
res <- adonis2(distance ~ group, data = metadata_pick, by = "terms")
p_value_embed_trans <- c(p_value_embed_trans, res$`Pr(>F)`[1])
R_embed_trans <- c(R_embed_trans, res$R2[1])
}
View(embed_tf)
for (i in study){
metadata_pick <- metadata %>% filter(Bioproject == i)
embed_tf_pick <- embed_tf[rownames(metadata_pick), ]
distance <- proxy::dist(embed_tf_pick, method = "cosine")
res <- adonis2(distance ~ group, data = metadata_pick, by = "terms")
p_value_embed_trans <- c(p_value_embed_trans, res$`Pr(>F)`[1])
R_embed_trans <- c(R_embed_trans, res$R2[1])
}
R_embed_trans
distance <- proxy::dist(embed_tf, method = "cosine")
res <- adonis2(distance ~ group, data = metadata, by = "terms", strata=metadata$Bioproject)
p_value_embed_trans <- c(p_value_embed_trans, res$`Pr(>F)`[1])
R_embed_trans <- c(R_embed_trans, res$R2[1])
R_embed_trans
R
# embedding transfor
embedding_file = read.table("/home/dongbiao/word_embedding_microbiome/databaes/16Sdatabase/glove/abundance-percentile/abundance-percentile_100.txt",
sep = " ", row.names = 1, header = FALSE)
View(embedding_file)
# emebdding attention
table_deep <- read.csv("/home/dongbiao/word_embedding_microbiome/programe_test/dim_reduction/IBD/attention_pooling.csv", row.names = 1)
View(table_deep)
# distance <- vegdist(table_deep, method = "euclidean")
p_value_attention <- c()
R_embed_attention <- c()
for (i in study){
metadata_pick <- metadata %>% filter(Bioproject == i)
table_deep_pick <- table_deep[rownames(metadata_pick), ]
distance <- proxy::dist(table_deep_pick, method = "cosine")
res <- adonis2(distance ~ group, data = metadata_pick, by = "terms")
p_value_attention <- c(p_value_attentions, res$`Pr(>F)`[1])
R_embed_attention <- c(R_embed_attention, res$R2[1])
}
# distance <- vegdist(table_deep, method = "euclidean")
p_value_attention <- c()
R_embed_attention <- c()
for (i in study){
metadata_pick <- metadata %>% filter(Bioproject == i)
table_deep_pick <- table_deep[rownames(metadata_pick), ]
distance <- proxy::dist(table_deep_pick, method = "cosine")
res <- adonis2(distance ~ group, data = metadata_pick, by = "terms")
p_value_attention <- c(p_value_attention, res$`Pr(>F)`[1])
R_embed_attention <- c(R_embed_attention, res$R2[1])
}
R_embed_attention
distance <- proxy::dist(table_deep, method = "cosine")
res <- adonis2(distance ~ group, data = metadata, by = "terms", strata=metadata$Bioproject)
p_value_attention <- c(p_value_attention, res$`Pr(>F)`[1])
R_embed_attention <- c(R_embed_attention, res$R2[1])
R_embed_attention
R_embed_trans
R
write.csv(res, "/home/dongbiao/word_embedding_microbiome/programe_test/IBD/explain/adonise2_res.csv")
View(res)
load("/home/dongbiao/word_embedding_microbiome/programe_test/IBD/explain/adonise2_res.RData")
res
adonis_ibd <- res
load("/home/dongbiao/word_embedding_microbiome/programe_test/CRC/explain_model/adonise2_res.RData")
anosim_crc <- res
adonis_ibd$group <- rep("IBD",nrow(adonis_ibd))
adonis_crc$group <- rep("CRC",nrow(adonis_crc))
load("/home/dongbiao/word_embedding_microbiome/programe_test/CRC/explain_model/adonise2_res.RData")
adonis_crc <- res
adonis_crc$group <- rep("CRC",nrow(adonis_crc))
adonis_res <- rbind(adonis_ibd, adonis_crc)
View(adonis_res)
adonis_res <- adonis_res %>% mutate(pvalue = ifelse(P < 0.05, "P < 0.05", "ns"))
load("/home/dongbiao/word_embedding_microbiome/programe_test/IBD/explain/adonise2_res.RData")
adonis_ibd <- res
adonis_ibd$group <- rep("IBD",nrow(adonis_ibd))
load("/home/dongbiao/word_embedding_microbiome/programe_test/CRC/explain_model/adonise2_res.RData")
adonis_crc <- res
adonis_crc$group2 <- rep("CRC",nrow(adonis_crc))
adonis_res <- rbind(adonis_ibd, adonis_crc)
load("/home/dongbiao/word_embedding_microbiome/programe_test/IBD/explain/adonise2_res.RData")
adonis_ibd <- res
adonis_ibd$group2 <- rep("IBD",nrow(adonis_ibd))
load("/home/dongbiao/word_embedding_microbiome/programe_test/CRC/explain_model/adonise2_res.RData")
adonis_crc <- res
adonis_crc$group2 <- rep("CRC",nrow(adonis_crc))
adonis_res <- rbind(adonis_ibd, adonis_crc)
adonis_res <- adonis_res %>% mutate(pvalue = ifelse(P < 0.05, "P < 0.05", "ns"))
ggplot(adonis_res, aes(x = R2, y = study, color = group, shape = pvalue)) +
geom_point(size = 3) +
scale_shape_manual(values = c(16, 17)) + # 圆点: ns，三角: P < 0.05
theme_minimal() +
labs(x = "R2", y = "", color = "Distance metric", shape = "Pvalue") +
theme(axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
legend.position = "right")
ggplot(adonis_res, aes(x = R2, y = study, color = group, shape = pvalue)) +
geom_point(size = 3) +
scale_shape_manual(values = c(16, 17)) + # 圆点: ns，三角: P < 0.05
theme_bw() +
facet_wrap(.~group2) +
labs(x = "R2", y = "", color = "Distance metric", shape = "Pvalue") +
theme(axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
legend.position = "right")
ggplot(adonis_res, aes(x = R2, y = study, color = group, shape = pvalue)) +
geom_point(size = 3) +
scale_shape_manual(values = c(16, 17)) + # 圆点: ns，三角: P < 0.05
theme_bw() +
facet_wrap(.~group2, scales = "free") +
labs(x = "R2", y = "", color = "Distance metric", shape = "Pvalue") +
theme(axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
legend.position = "right")
ggplot(adonis_res, aes(x = R2, y = study, color = group, shape = pvalue)) +
geom_point(size = 3) +
scale_shape_manual(values = c(16, 17)) + # 圆点: ns，三角: P < 0.05
theme_bw(base_size=14) +
facet_wrap(.~group2, scales = "free") +
labs(x = "R2", y = "", color = "", shape = "Pvalue") +
theme(axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
legend.position = "right") +
theme(text = element_text(face = "bold"), # 设置所有文本为加粗
legend.position = "None",
plot.title = element_text(hjust = 0.5), # 居中对齐标题
axis.title = element_text(face = "bold"), # 加粗坐标轴标题
axis.text = element_text(face = "bold"))
ggplot(adonis_res, aes(x = R2, y = study, color = group, shape = pvalue)) +
geom_point(size = 3) +
scale_shape_manual(values = c(16, 17)) + # 圆点: ns，三角: P < 0.05
theme_bw(base_size=14) +
facet_wrap(.~group2, scales = "free") +
labs(x = "R2", y = "", color = "", shape = "Pvalue") +
theme(axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
legend.position = "right") +
theme(text = element_text(face = "bold"), # 设置所有文本为加粗
plot.title = element_text(hjust = 0.5), # 居中对齐标题
axis.title = element_text(face = "bold"), # 加粗坐标轴标题
axis.text = element_text(face = "bold"))
ggplot(adonis_res, aes(x = R2, y = study, color = group, shape = pvalue)) +
geom_point(size = 3) +
scale_shape_manual(values = c(16, 17)) + # 圆点: ns，三角: P < 0.05
theme_bw(base_size=14) +
facet_wrap(.~group2, scales = "free") +
labs(x = "R2", y = "", color = "", shape = "Pvalue") +
scale_color_brewer(palette = "Paired") +
theme(axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
legend.position = "right") +
theme(text = element_text(face = "bold"), # 设置所有文本为加粗
plot.title = element_text(hjust = 0.5), # 居中对齐标题
axis.title = element_text(face = "bold"), # 加粗坐标轴标题
axis.text = element_text(face = "bold"))
adonis_res$group2 <- factor(adonis_res$group2, levels = c("IBD", "CRC"))
p1 <- ggplot(adonis_res, aes(x = R2, y = study, color = group, shape = pvalue)) +
geom_point(size = 3) +
scale_shape_manual(values = c(16, 17)) + # 圆点: ns，三角: P < 0.05
theme_bw(base_size=14) +
facet_wrap(.~group2, scales = "free") +
labs(x = "R2", y = "", color = "", shape = "Pvalue") +
scale_color_brewer(palette = "Paired") +
theme(axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
legend.position = "right") +
theme(text = element_text(face = "bold"), # 设置所有文本为加粗
plot.title = element_text(hjust = 0.5), # 居中对齐标题
axis.title = element_text(face = "bold"), # 加粗坐标轴标题
axis.text = element_text(face = "bold"))
p1
table <- read_biom("/home/dongbiao/word_embedding_microbiome/programe_test/IBD/data/table.biom")
biom_df <- as.data.frame(table$data)
colnames(biom_df) <- unlist(table$rows)
biom_df <- biom_df / rowSums(biom_df)
metadata <- read.table("/home/dongbiao/word_embedding_microbiome/programe_test/IBD/data/metadata.txt", sep = "\t", header = TRUE)
metadata <- metadata[, c("sample", "study", "diagnosis", "region", "country")] %>%
column_to_rownames("sample")
metadata <- metadata[rownames(biom_df), ]
colnames(metadata) <- c("Bioproject", "group", "Region", "country")
study <- c('PRJNA422193', 'PRJNA431126', 'qiita_1629', 'qiita_2538', 'HMP', 'PRJEB13679', 'PRJNA317429')
distance <- vegdist(table_pick, method = "bray")
distance <- vegdist(biom_df, method = "bray")
res_1 <- adonis2(distance ~ Bioproject + group + country, data = metadata, by = "terms")
res_1
View(metadata)
data.frame(res_1)
res_1 <- adonis2(distance ~  group + country + Bioproject, data = metadata, by = "terms")
res_1
# embedding transfor
embedding_file = read.table("/home/dongbiao/word_embedding_microbiome/databaes/16Sdatabase/glove/abundance-percentile/abundance-percentile_100.txt",
sep = " ", row.names = 1, header = FALSE)
inter_id <- intersect(rownames(embedding_file), colnames(biom_df))
embed_tf <- as.matrix(biom_df[, inter_id]) %*% as.matrix(embedding_file[inter_id, ])
distance <- proxy::dist(embed_tf, method = "cosine")
res_2 <- adonis2(distance ~  group + country + Bioproject, data = metadata, by = "terms")
res_2
res_1
# emebdding attention
table_deep <- read.csv("/home/dongbiao/word_embedding_microbiome/programe_test/dim_reduction/IBD/attention_pooling.csv", row.names = 1)
table_deep <- table_deep[rownames(metadata), ]
distance <- proxy::dist(table_deep, method = "cosine")
res_3 <- adonis2(distance ~  group + country + Bioproject, data = metadata, by = "terms")
res_3
# }
# distance <- proxy::dist(table_deep, method = "cosine")
# res <- adonis2(distance ~ group, data = metadata, by = "terms", strata=metadata$Bioproject)
# p_value_attention <- c(p_value_attention, res$`Pr(>F)`[1])
# R_embed_attention <- c(R_embed_attention, res$R2[1])
#
# res <- data.frame(R2=c(R, R_embed_trans, R_embed_attention), P=c(p_value, p_value_embed_trans, p_value_attention),
#                   group=c(rep("Raw", length(R)), rep("EmbS-Matrix", length(R_embed_trans)),
#                           rep("Attention", length(R_embed_attention))))
# res$study <- rep(c(study, "Combined"), times=3)
data.frame(res_1)
res_1 <- data.frame(res_1)
View(res_1)
res_2 <- data.frame(res_2)
res_3 <- data.frame(res_3)
# }
# distance <- proxy::dist(table_deep, method = "cosine")
# res <- adonis2(distance ~ group, data = metadata, by = "terms", strata=metadata$Bioproject)
# p_value_attention <- c(p_value_attention, res$`Pr(>F)`[1])
# R_embed_attention <- c(R_embed_attention, res$R2[1])
#
# res <- data.frame(R2=c(R, R_embed_trans, R_embed_attention), P=c(p_value, p_value_embed_trans, p_value_attention),
#                   group=c(rep("Raw", length(R)), rep("EmbS-Matrix", length(R_embed_trans)),
#                           rep("Attention", length(R_embed_attention))))
# res$study <- rep(c(study, "Combined"), times=3)
res <- rbind(res_1, res_2, res_3)
View(res)
rownames(res_1)
# }
# distance <- proxy::dist(table_deep, method = "cosine")
# res <- adonis2(distance ~ group, data = metadata, by = "terms", strata=metadata$Bioproject)
# p_value_attention <- c(p_value_attention, res$`Pr(>F)`[1])
# R_embed_attention <- c(R_embed_attention, res$R2[1])
#
# res <- data.frame(R2=c(R, R_embed_trans, R_embed_attention), P=c(p_value, p_value_embed_trans, p_value_attention),
#                   group=c(rep("Raw", length(R)), rep("EmbS-Matrix", length(R_embed_trans)),
#                           rep("Attention", length(R_embed_attention))))
# res$study <- rep(c(study, "Combined"), times=3)
res <- rbind(res_1[c("group", "country", "Bioproject"), ],
res_2[c("group", "country", "Bioproject"), ],
res_3[c("group", "country", "Bioproject"), ])
res_1
# }
# distance <- proxy::dist(table_deep, method = "cosine")
# res <- adonis2(distance ~ group, data = metadata, by = "terms", strata=metadata$Bioproject)
# p_value_attention <- c(p_value_attention, res$`Pr(>F)`[1])
# R_embed_attention <- c(R_embed_attention, res$R2[1])
#
# res <- data.frame(R2=c(R, R_embed_trans, R_embed_attention), P=c(p_value, p_value_embed_trans, p_value_attention),
#                   group=c(rep("Raw", length(R)), rep("EmbS-Matrix", length(R_embed_trans)),
#                           rep("Attention", length(R_embed_attention))))
# res$study <- rep(c(study, "Combined"), times=3)
res <- rbind(res_1[c("group", "country", "Bioproject"), c("R2", "Pr..F.")],
res_2[c("group", "country", "Bioproject"), c("R2", "Pr..F.")],
res_3[c("group", "country", "Bioproject"), c("R2", "Pr..F.")])
res$group1 <- rep("Raw data", "EmbS-Matrix", "Attention", times=3)
res$group1 <- rep(c("Raw data", "EmbS-Matrix", "Attention"), times=3)
View(res)
res$group1 <- rep(c("Raw data", "EmbS-Matrix", "Attention"), each=3)
View(res)
write.csv(res, "/home/dongbiao/word_embedding_microbiome/programe_test/IBD/explain/adonise2_res.csv")
res$group2 <- rep(c("group", "country", "Bioproject"), times=3)
write.csv(res, "/home/dongbiao/word_embedding_microbiome/programe_test/IBD/explain/adonise2_res.csv")
res$group2 <- rep(c("Group", "Country", "Study"), times=3)
write.csv(res, "/home/dongbiao/word_embedding_microbiome/programe_test/IBD/explain/adonise2_res.csv")
table <- read_biom("/home/dongbiao/word_embedding_microbiome/programe_test/CRC/data/table.biom")
biom_df <- as.data.frame(table$data)
colnames(biom_df) <- unlist(table$rows)
biom_df <- biom_df / rowSums(biom_df)
study <- c('PRJEB36789', 'PRJNA824020', 'PRJDB11845', 'PRJNA318004',
'PRJEB6070', 'PRJNA430990', 'PRJNA290926')
metadata <- read.table("/home/dongbiao/word_embedding_microbiome/programe_test/CRC/data/metadata.txt", sep = "\t", header = TRUE)
metadata <- metadata[, c("Run", "BioProject", "group", "Sequencing.region")] %>% column_to_rownames("Run")
colnames(metadata) <- c("Bioproject", "group", "Region")
metadata <- metadata[rownames(biom_df), ] %>% filter(Bioproject %in% study)
biom_df <- biom_df[rownames(metadata), ] %>% select_if(~ any(. != 0))
metadata <- read.table("/home/dongbiao/word_embedding_microbiome/programe_test/CRC/data/metadata.txt", sep = "\t", header = TRUE)
View(metadata)
colnames(metadata)
metadata <- read.table("/home/dongbiao/word_embedding_microbiome/programe_test/CRC/data/metadata.txt", sep = "\t", header = TRUE)
metadata <- metadata[, c("Run", "BioProject", "group", "Sequencing.region", "geo_loc_name_country")] %>% column_to_rownames("Run")
colnames(metadata) <- c("Bioproject", "group", "Region", "country")
metadata <- metadata[rownames(biom_df), ] %>% filter(Bioproject %in% study)
biom_df <- biom_df[rownames(metadata), ] %>% select_if(~ any(. != 0))
distance <- vegdist(biom_df, method = "bray")
res_1 <- adonis2(distance ~  group + country + Region + Bioproject, data = metadata, by = "terms")
res_1
# embedding transfor
embedding_file = read.table("/home/dongbiao/word_embedding_microbiome/databaes/16Sdatabase/glove/abundance-percentile/abundance-percentile_100.txt",
sep = " ", row.names = 1, header = FALSE)
inter_id <- intersect(rownames(embedding_file), colnames(biom_df))
embed_tf <- as.matrix(biom_df[, inter_id]) %*% as.matrix(embedding_file[inter_id, ])
embed_tf <- embed_tf[rownames(metadata), ]
distance <- proxy::dist(embed_tf, method = "cosine")
res_2 <- adonis2(distance ~  group + country + Bioproject, data = metadata, by = "terms")
res_2 <- data.frame(res_2)
res_2
res_1
res_1 <- data.frame(res_1)
res_2 <- adonis2(distance ~  group + country + Region + Bioproject, data = metadata, by = "terms")
View(res)
res$type <- rep("IBD", nrow(res))
write.csv(res, "/home/dongbiao/word_embedding_microbiome/programe_test/IBD/explain/adonise2_res.csv")
res_2
res_2 <- data.frame(res_2)
res_2
View(res_1)
View(res_2)
# emebdding attention
table_deep <- read.csv("/home/dongbiao/word_embedding_microbiome/programe_test/dim_reduction/CRC/attention_pooling.csv", row.names = 1)
table_deep <- table_deep[rownames(metadata), ]
distance <- proxy::dist(table_deep, method = "cosine")
res_3 <- adonis2(distance ~  group + country + Region + Bioproject, data = metadata, by = "terms")
res_3 <- data.frame(res_3)
res_3
distance <- vegdist(biom_df, method = "bray")
res_1 <- adonis2(distance ~  group + country + Region + Bioproject, data = metadata, by = "margin")
res_1 <- data.frame(res_1)
res_1
distance <- proxy::dist(embed_tf, method = "cosine")
res_2 <- adonis2(distance ~  group + country + Region + Bioproject, data = metadata, by = "margin")
res_2 <- data.frame(res_2)
res_2
res_1
res_2
res_1
View(metadata)
unique(metadata$Region)
View(embed_tf)
distance <- proxy::dist(table_deep, method = "cosine")
res_3 <- adonis2(distance ~  group + country + Region + Bioproject, data = metadata, by = "margin")
res_3 <- data.frame(res_3)
res_3
View(res)
distance <- proxy::dist(embed_tf, method = "cosine")
res_2 <- adonis2(distance ~  group + country + Region + Bioproject, data = metadata, by = "terms")
res_2 <- data.frame(res_2)
res_2
distance <- vegdist(biom_df, method = "bray")
res_1 <- adonis2(distance ~  group + Region + country + Bioproject, data = metadata, by = "terms")
res_1 <- data.frame(res_1)
distance <- proxy::dist(embed_tf, method = "cosine")
res_2 <- adonis2(distance ~  group + Region + country + Bioproject, data = metadata, by = "terms")
res_2 <- data.frame(res_2)
res_2
res_1
# emebdding attention
table_deep <- read.csv("/home/dongbiao/word_embedding_microbiome/programe_test/dim_reduction/CRC/attention_pooling.csv", row.names = 1)
table_deep <- table_deep[rownames(metadata), ]
distance <- proxy::dist(table_deep, method = "cosine")
res_3 <- adonis2(distance ~  group + Region + country + Bioproject, data = metadata, by = "terms")
res_3 <- data.frame(res_3)
res_3
res <- rbind(res_1[c("group", "country", "Bioproject"), c("R2", "Pr..F.")],
res_2[c("group", "country", "Bioproject"), c("R2", "Pr..F.")],
res_3[c("group", "country", "Bioproject"), c("R2", "Pr..F.")])
res$group1 <- rep(c("Raw data", "EmbS-Matrix", "Attention"), each=3)
res$group2 <- rep(c("Group", "Country", "Study"), times=3)
res$type <- rep("CRC", nrow(res))
write.csv(res, "/home/dongbiao/word_embedding_microbiome/programe_test/dim_reduction/CRC/adonise2_res.csv")
View(res)
res <- rbind(res_1[c("group", "Region", "country", "Bioproject"), c("R2", "Pr..F.")],
res_2[c("group", "Region", "country", "Bioproject"), c("R2", "Pr..F.")],
res_3[c("group", "Region", "country", "Bioproject"), c("R2", "Pr..F.")])
res$group1 <- rep(c("Raw data", "EmbS-Matrix", "Attention"), each=3)
res$group1 <- rep(c("Raw data", "EmbS-Matrix", "Attention"), each=4)
res$group2 <- rep(c("Group", "Country", "Study"), times=4)
res$type <- rep("CRC", nrow(res))
write.csv(res, "/home/dongbiao/word_embedding_microbiome/programe_test/dim_reduction/CRC/adonise2_res.csv")
res <- rbind(res_1[c("group", "Region", "country", "Bioproject"), c("R2", "Pr..F.")],
res_2[c("group", "Region", "country", "Bioproject"), c("R2", "Pr..F.")],
res_3[c("group", "Region", "country", "Bioproject"), c("R2", "Pr..F.")])
res$group1 <- rep(c("Raw data", "EmbS-Matrix", "Attention"), each=4)
res$group2 <- rep(c("Group", "Region", "Country", "Study"), times=3)
res$type <- rep("CRC", nrow(res))
write.csv(res, "/home/dongbiao/word_embedding_microbiome/programe_test/dim_reduction/CRC/adonise2_res.csv")
#     facet_wrap(.~group2, scales = "free") +
#     labs(x = "R2", y = "", color = "", shape = "Pvalue") +
#     scale_color_brewer(palette = "Paired") +
#     theme(axis.text.y = element_text(size = 10),
#           axis.text.x = element_text(size = 10),
#           legend.position = "right") +
#     theme(text = element_text(face = "bold"), # 设置所有文本为加粗
#           plot.title = element_text(hjust = 0.5), # 居中对齐标题
#           axis.title = element_text(face = "bold"), # 加粗坐标轴标题
#           axis.text = element_text(face = "bold"))
adonis_ibd <- read.csv("/home/dongbiao/word_embedding_microbiome/programe_test/IBD/explain/adonise2_res.csv")
View(adonis_ibd)
#     facet_wrap(.~group2, scales = "free") +
#     labs(x = "R2", y = "", color = "", shape = "Pvalue") +
#     scale_color_brewer(palette = "Paired") +
#     theme(axis.text.y = element_text(size = 10),
#           axis.text.x = element_text(size = 10),
#           legend.position = "right") +
#     theme(text = element_text(face = "bold"), # 设置所有文本为加粗
#           plot.title = element_text(hjust = 0.5), # 居中对齐标题
#           axis.title = element_text(face = "bold"), # 加粗坐标轴标题
#           axis.text = element_text(face = "bold"))
adonis_ibd <- read.csv("/home/dongbiao/word_embedding_microbiome/programe_test/IBD/explain/adonise2_res.csv")
adonis_crc <- read.csv("/home/dongbiao/word_embedding_microbiome/programe_test/dim_reduction/CRC/adonise2_res.csv")
adonis_res <- rbind(adonis_ibd, adonis_crc)
View(adonis_res)
adonis_res$group2 <- factor(adonis_res$group2, levels = c("Group", "Region", "Country", "Study"))
adonis_res %>% ggplot(aes(x=group2, y=R2, fill=group1)) +
geom_bar() +
facet_wrap(.~type, scales = "free")
adonis_res %>% ggplot(aes(x=group2, y=R2, fill=group1)) +
geom_bar(tat = "identity", position = "dodge") +
facet_wrap(.~type, scales = "free")
adonis_res %>% ggplot(aes(x=group2, y=R2, fill=group1)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(.~type, scales = "free")
adonis_res$type <- factor(adonis_res$type, levels = c("IBD", "CRC"))
adonis_res %>% ggplot(aes(x=group2, y=R2, fill=group1)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(.~type, scales = "free") +
scale_color_brewer(palette = "Paired") +
theme(axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
legend.position = "right") +
theme(text = element_text(face = "bold"), # 设置所有文本为加粗
plot.title = element_text(hjust = 0.5), # 居中对齐标题
axis.title = element_text(face = "bold"), # 加粗坐标轴标题
axis.text = element_text(face = "bold"))
adonis_res %>% ggplot(aes(x=group2, y=R2, fill=group1)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(.~type, scales = "free") +
scale_color_brewer(palette = "Paired") +
theme(axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
legend.position = "right") +
labs(x = "R2", y = "", fill = "") +
theme(text = element_text(face = "bold"), # 设置所有文本为加粗
plot.title = element_text(hjust = 0.5), # 居中对齐标题
axis.title = element_text(face = "bold"), # 加粗坐标轴标题
axis.text = element_text(face = "bold"))
adonis_res %>% ggplot(aes(x=group2, y=R2, fill=group1)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(.~type, scales = "free") +
scale_fill_brewer(palette = "Paired") +
theme(axis.text.y = element_text(size = 10),
axis.text.x = element_text(size = 10),
legend.position = "right") +
labs(x = "R2", y = "", fill = "") +
theme(text = element_text(face = "bold"), # 设置所有文本为加粗
plot.title = element_text(hjust = 0.5), # 居中对齐标题
axis.title = element_text(face = "bold"), # 加粗坐标轴标题
axis.text = element_text(face = "bold"))
